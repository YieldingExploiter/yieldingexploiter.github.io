// libs
const fs = require('fs'),
	path = require('path');
const svgjs = require('svg.js'),
	svgdom = require('svgdom');

// stuff
const window = svgdom.createSVGWindow();
const svg = svgjs(window);
const document = window.document;
const canvas = svg(document.documentElement);

const ps1 = [
	['yielding@github', '#88e233'],
	[':', '#fbfdfd'],
	['~', '#5e94bd'],
	['$ ', '#fbfdfd'],
];

const text = [
	...ps1,
	['cat README.txt', '#dddddd'],
	'NEWLINE',
	[
		fs.readFileSync(path.resolve(__filename, '..', '_svg.README.txt'), 'utf-8'),
		'#eeeeee',
	],
	'NEWLINE',
	...ps1,
];

let _text = canvas.text('​');
_text.build(true);

let i = 0;

text.forEach(v => {
	if (v == 'NEWLINE') {
		_text.build(false);
		_text.font('family', 'monospace');
		i++;
		_text = canvas.text('\n​'.repeat(i));
		_text.build(true);
	} else {
		_text.tspan(v[0]).fill(v[1]);
	}
});

_text.build(false);
_text.font('family', 'monospace');

// export svg
fs.writeFileSync('img/console.svg', canvas.svg(), {
	encoding: 'utf-8',
});
